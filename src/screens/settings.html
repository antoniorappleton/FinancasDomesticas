<section class="card">
  <h2 class="section-title">Importação CSV</h2>

  <div class="form-grid">
    <label>
      Ficheiro CSV
      <input id="imp-file" type="file" accept=".csv,text/csv" />
    </label>
    <label>
      Mês (para registo)
      <input id="imp-month" type="month" />
    </label>
  </div>

  <div class="actions" style="margin-top:8px">
    <button id="imp-preview" class="btn">Pré-visualizar</button>
    <button id="imp-import"  class="btn btn--primary">Importar</button>
    <button id="imp-clear"   class="btn">Limpar pré-visualização</button>
  </div>

  <p id="imp-info" class="row-note"></p>
  <pre id="imp-log" class="row-note" style="white-space:pre-wrap"></pre>

  <div id="imp-table-wrap" class="card soft" style="margin-top:12px; display:none">
    <h3 class="section-title">Pré-visualização</h3>
    <div style="overflow:auto">
      <table id="imp-table">
        <thead></thead>
        <tbody></tbody>
      </table>
    </div>
  </div>
</section>

<section class="card">
  <h2 class="section-title">Relatórios</h2>

  <div class="grid" style="grid-template-columns: repeat(4, minmax(0,1fr)); gap:10px">
    <label>
      Tipo
      <select id="rpt-type">
        <option value="monthly" selected>Mensal</option>
        <option value="range">Intervalo de meses</option>
        <option value="yearly">Anual</option>
      </select>
    </label>

    <label id="rpt-month-wrap">
      Mês
      <input id="rpt-month" type="month" />
    </label>

    <label id="rpt-range-wrap" class="hidden">
      De (YYYY-MM)
      <input id="rpt-from" type="month" />
    </label>

    <label id="rpt-range2-wrap" class="hidden">
      Até (YYYY-MM)
      <input id="rpt-to" type="month" />
    </label>

    <label id="rpt-year-wrap" class="hidden">
      Ano
      <input id="rpt-year" type="number" min="2000" max="2100" step="1" />
    </label>
  </div>

  <div style="display:flex; gap:8px; justify-content:flex-end; margin-top:10px">
    <button id="btn-report-open" class="btn btn--primary">Abrir relatório…</button>
  </div>
</section>

<!-- ===== MODAL RELATÓRIO ===== -->
<div id="report-overlay" class="rep-overlay hidden" aria-hidden="true">
  <div class="rep-modal" role="dialog" aria-modal="true" aria-labelledby="rpt-title">
    <header class="rep-header">
      <h3 id="rpt-title">Relatório Financeiro</h3>
      <button id="rpt-close" class="icon-btn" aria-label="Fechar">✕</button>
    </header>

    <div class="rep-body">
      <!-- KPIs -->
      <section class="grid rpt-kpis">
        <div class="kpi"><div class="kpi__label">Receitas</div><div id="rpt-kpi-income"  class="kpi__value">—</div></div>
        <div class="kpi"><div class="kpi__label">Despesas</div><div id="rpt-kpi-expense" class="kpi__value">—</div></div>
        <div class="kpi"><div class="kpi__label">Poupanças</div><div id="rpt-kpi-savings" class="kpi__value">—</div></div>
        <div class="kpi"><div class="kpi__label">Saldo</div><div id="rpt-kpi-balance" class="kpi__value">—</div></div>
      </section>

      <!-- Pizza categorias -->
      <section class="card soft">
        <h4 class="section-title">Distribuição de despesas por categorias</h4>
        <div class="chart"><canvas id="rpt-cat-pie"></canvas></div>
        <div id="rpt-cat-legend" class="rpt-legend"></div>
      </section>

      <!-- Donut fixas/variáveis -->
      <section class="card soft">
        <h4 class="section-title">Fixas vs Variáveis</h4>
        <div class="chart"><canvas id="rpt-fixed-donut"></canvas></div>
      </section>

      <!-- Séries 12m -->
      <section class="card soft">
        <h4 class="section-title">Séries mensais</h4>
        <div class="chart"><canvas id="rpt-series"></canvas></div>
      </section>

      <!-- Insights (placeholder) -->
      <section class="card soft">
        <h4 class="section-title">Insights & Indicadores</h4>
        <ul id="rpt-insights" class="row-note" style="margin:0"></ul>
      </section>
    </div>

    <footer class="rep-footer" style="display:flex; gap:8px; justify-content:flex-end; padding:12px 16px">
      <button id="rpt-export" class="btn">Exportar PDF</button>
    </footer>
  </div>
</div>

<!-- ===== MANUTENÇÃO DE DADOS ===== -->
<section class="card">
  <h2 class="section-title">Manutenção de Dados</h2>
  <div class="actions">
    <button id="btn-del-month" class="btn btn--primary" style="background:#ef4444;border-color:#ef4444">Eliminar Mês Atual</button>
    <button id="btn-del-range" class="btn">Eliminar Período…</button>
    <button id="btn-del-all" class="btn">Eliminar Tudo…</button>
  </div>
  <p class="row-note">Estas ações afetam apenas os seus dados (RLS ativo).</p>
</section>

<!-- ===== ENTIDADES: CATEGORIAS & CONTAS ===== -->
<section class="card">
  <h2 class="section-title">Categorias</h2>
  <div class="actions">
    <button id="btn-new-cat" class="btn">Nova Categoria</button>
  </div>
  <div id="list-cats" class="list" style="display:flex;flex-direction:column;gap:10px"></div>
</section>

<section class="card">
  <h2 class="section-title">Contas</h2>
  <div class="actions">
    <button id="btn-new-acc" class="btn">Nova Conta</button>
  </div>
  <div id="list-accs" class="list" style="display:flex;flex-direction:column;gap:10px"></div>
</section>
