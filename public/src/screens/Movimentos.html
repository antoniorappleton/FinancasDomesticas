<section class="card">
  <h2 class="section-title">Movimentos</h2>

  <!-- Filtros -->
  <div class="filters-grid" style="display: flex; flex-wrap: wrap; gap: 8px">
    <label class="toggle" style="flex: 1 1 200px">
      <input
        id="flt-search"
        type="text"
        placeholder="Pesquisar descrição, categoria, localização…"
      />
      <span></span>
    </label>

    <label class="toggle" style="flex: 1 1 140px">
      <select id="flt-type">
        <option value="all">Todos os tipos</option>
        <option value="INCOME">Receita</option>
        <option value="EXPENSE">Despesa</option>
        <option value="SAVINGS">Poupança</option>
      </select>
      <span></span>
    </label>

    <label class="toggle" style="flex: 1 1 140px">
      <select id="flt-status">
        <option value="all">Todos os status</option>
      </select>
      <span></span>
    </label>

    <label class="toggle" style="flex: 1 1 140px">
      <input id="flt-month" type="month" />
      <span></span>
    </label>
  </div>

  <div
    class="actions"
    style="margin-top: 10px; display: flex; gap: 8px; flex-wrap: wrap"
  >
    <button id="btn-refresh" class="btn">Atualizar</button>
    <a href="#/new" class="btn btn--primary">+ Novo Movimento</a>
  </div>
</section>

<section class="card" style="overflow: auto">
  <div class="rounded-md" style="border: 1px solid var(--border, #e5e7eb)">
    <table style="width: 100%; border-collapse: collapse">
      <thead style="background: #f8fafc">
        <tr>
          <th
            style="
              text-align: left;
              padding: 10px;
              border-bottom: 1px solid var(--border, #e5e7eb);
            "
          >
            Data
          </th>
          <th
            style="
              text-align: left;
              padding: 10px;
              border-bottom: 1px solid var(--border, #e5e7eb);
            "
          >
            Tipo
          </th>
          <th
            style="
              text-align: right;
              padding: 10px;
              border-bottom: 1px solid var(--border, #e5e7eb);
            "
          >
            Valor
          </th>
          <th
            style="
              text-align: left;
              padding: 10px;
              border-bottom: 1px solid var(--border, #e5e7eb);
            "
          >
            Categoria
          </th>
          <th
            style="
              text-align: left;
              padding: 10px;
              border-bottom: 1px solid var(--border, #e5e7eb);
            "
          >
            Descrição
          </th>
          <th
            style="
              text-align: left;
              padding: 10px;
              border-bottom: 1px solid var(--border, #e5e7eb);
            "
          >
            Conta
          </th>
          <th
            style="
              text-align: left;
              padding: 10px;
              border-bottom: 1px solid var(--border, #e5e7eb);
            "
          >
            Status
          </th>
          <th
            style="
              text-align: left;
              padding: 10px;
              border-bottom: 1px solid var(--border, #e5e7eb);
            "
          >
            Localização
          </th>
        </tr>
      </thead>
      <tbody id="tx-tbody">
        <!-- linhas via JS -->
      </tbody>
    </table>
  </div>

  <div id="tx-summary" class="row-note" style="margin-top: 8px"></div>

  <div class="actions" style="margin-top: 10px">
    <button id="btn-load-more" class="btn">Carregar mais</button>
  </div>
</section>

<!-- Modal Editar -->
<section id="tx-edit-modal" class="modal" hidden>
  <div class="modal__card">
    <header class="modal__header">
      <div>
        <div class="modal__title">Editar transação</div>
        <div id="tx-edit-meta" class="badge-muted"></div>
      </div>
      <button class="modal__close" data-close>&times;</button>
    </header>

    <div
      class="form-grid"
      style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px"
    >
      <label>Data <input id="ed-date" type="date" required /></label>
      <label
        >Valor (€)
        <input id="ed-amount" type="number" step="0.01" min="0.01" required
      /></label>

      <label
        >Conta
        <select id="ed-account"></select>
      </label>
      <label
        >Regularidade
        <select id="ed-regularity"></select>
      </label>

      <label
        >Tipo
        <select id="ed-type" disabled></select>
      </label>
      <label
        >Categoria
        <select id="ed-category"></select>
      </label>

      <label
        >Método
        <select id="ed-method"></select>
      </label>
      <label
        >Status
        <select id="ed-status"></select>
      </label>

      <label
        >Natureza
        <select id="ed-nature">
          <option value="">(usar predefinição da categoria)</option>
          <option value="fixed">Fixa</option>
          <option value="variable">Variável</option>
        </select>
      </label>

      <label style="grid-column: 1/-1"
        >Descrição
        <input id="ed-desc" type="text" />
      </label>
      <label
        >Localização
        <input id="ed-loc" type="text" />
      </label>
      <label
        >Notas
        <textarea id="ed-notes"></textarea>
      </label>
    </div>

    <div id="ed-hint" class="row-note"></div>

    <div
      class="actions"
      style="
        display: flex;
        gap: 8px;
        justify-content: flex-end;
        margin-top: 12px;
      "
    >
      <button
        id="ed-delete"
        class="btn"
        style="border-color: #ef4444; color: #ef4444"
      >
        Eliminar
      </button>
      <button id="ed-cancel" class="btn">Cancelar</button>
      <button id="ed-save" class="btn btn--primary">Guardar</button>
    </div>
  </div>
  </div>
</section>

<!-- Modal Relatório -->
<section id="report-modal" class="modal" hidden>
  <div class="modal__card" style="max-height: 85vh; display: flex; flex-direction: column;">
    <header class="modal__header" style="background: var(--bg-surface); border-bottom: 1px solid var(--border);">
      <div>
        <div class="modal__title" id="report-title">Relatório</div>
        <div class="badge-muted" id="report-date"></div>
      </div>
      <button class="modal__close" data-close>&times;</button>
    </header>

    <div style="flex: 1; overflow-y: auto; padding: 16px;">
      <div style="text-align: center; margin-bottom: 20px;">
        <div style="font-size: 0.9rem; color: var(--text-muted);">Total Gasto</div>
        <div id="report-total" style="font-size: 2rem; font-weight: 700; color: #ef4444;">--</div>
      </div>

      <h3 style="font-size: 1rem; margin-bottom: 10px; border-bottom: 1px solid var(--border); padding-bottom: 4px;">Top Despesas</h3>
      <ul id="report-list" style="list-style: none; padding: 0; margin: 0; display: flex; flex-direction: column; gap: 8px;">
        <!-- Items injected via JS -->
      </ul>
    </div>

    <div class="actions" style="padding: 12px; border-top: 1px solid var(--border); text-align: right;">
      <button class="btn btn--primary" data-close>Fechar</button>
    </div>
  </div>
</section>
